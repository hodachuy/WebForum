@using MvcForum.Web.ViewModels
@using MvcForum.Web.ViewModels.Category
@model List<SectionListViewModel>
@{
    Layout = null;
}
<div class="categoryindex">
   
    @foreach (var sectionItem in Model.OrderBy(x => x.Section.SortOrder))
    {
        if (sectionItem.AllPermissionSets.Any())
        {
            <div class="panel panel-mvc">
                <div class="col-md-12 panel-heading">
                    <div class="col-md-7">
                        <span>@(sectionItem.Section.Name.ToUpper())</span>
                    </div>
                    <div class="col-md-2 text-center">
                        <span>Chủ đề/Bình luận</span>
                    </div>
                    <div class="col-md-2 text-center">
                        <span>Bài viết cuối</span>
                    </div>
                    <div class="col-md-1 text-center">
                        <a data-toggle="collapse" data-target="#collap-@sectionItem.Section.Id">
                        </a>
                    </div>
                </div>
                <div id="collap-@sectionItem.Section.Id" class="panel-collapse collapse in">
                    <div class="panel-body">                       
                        @foreach (var cat in sectionItem.AllPermissionSets.Keys)
                        {
                            var permissions = sectionItem.AllPermissionSets[cat];

                            @Html.Partial("_Category", new CategoryViewModel {
                                Category = cat.Category,
                                LatestTopic = cat.MostRecentTopic,
                                Permissions = permissions,
                                PostCount = cat.PostCount,
                                TopicCount = cat.TopicCount
                            })

                        }
                    </div>

                </div>
            </div>   
        }
    }

</div>
